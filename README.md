## üöï –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–µ–∑–¥–æ–∫ —Ç–∞–∫—Å–∏ NYC + –ø–æ–≥–æ–¥–∞ (Scala/Spark ‚Üí Hive)
–¶–µ–ª—å: —Å–æ–±—Ä–∞—Ç—å –ø–æ–º–µ—Å—è—á–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–µ–∑–¥–æ–∫ (NYC TLC), –æ–±–æ–≥–∞—Ç–∏—Ç—å –ø–æ–≥–æ–¥–æ–π –ø–æ —á–∞—Å–∞–º –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–∏—Ç—Ä–∏–Ω—É —Å –ø–æ—á–∞—Å–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ –∑–æ–Ω–∞–º –≥–æ—Ä–æ–¥–∞\
## üìò –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  * –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–µ–∑–¥–∫–∞—Ö –ñ–µ–ª—Ç–æ–≥–æ —Ç–∞–∫—Å–∏ (Trips): NYC TLC Yellow/Green Trip Records (parquet, –∑–∞ 1 –º–µ—Å—è—Ü).
  * –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∑–æ–Ω: taxi_zone_lookup.csv.
  * –ü–æ–≥–æ–¥–∞ NYC –ø–æ —á–∞—Å–∞–º: –ø–æ—á–∞—Å–æ–≤–æ–π dataset. –ö–ª—é—á ‚Äî –º–µ—Ç–∫–∞ —á–∞—Å–∞.
## üìä –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç
  * –ó–∞–≥—Ä—É–∂–∞–µ–º NYC TLC trip records (Yellow Taxi) –∏–∑ HDFS
  * –ß–∏—Å—Ç–∏–º –¥–∞–Ω–Ω—ã–µ (–æ—Ç–±—Ä–æ—Å –∞–Ω–æ–º–∞–ª–∏–π, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏, —Å–∫–æ—Ä–æ—Å—Ç—å, –¥—É–±–ª–∏–∫–∞—Ç—ã)
  * –û–±–æ–≥–∞—â–∞–µ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –∑–æ–Ω –≥–æ—Ä–æ–¥–∞ –∏ –ø–æ—á–∞—Å–æ–≤—ã–º–∏ –ø–æ–≥–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  * –°—á–∏—Ç–∞–µ–º –∞–≥—Ä–µ–≥–∞—Ç—ã –ø–æ —á–∞—Å–∞–º –∏ –∑–æ–Ω–∞–º:
    * —á–∏—Å–ª–æ –ø–æ–µ–∑–¥–æ–∫
    * —Å—Ä–µ–¥–Ω—è—è, –º–µ–¥–∏–∞–Ω–Ω–∞—è (p50) –∏ 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    * —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å (–∫–º/—á)
    * –≤—ã—Ä—É—á–∫–∞
    * –¥–æ–ª—è –Ω–∞–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
    * —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –æ—Å–∞–¥–∫–∏
  * –°—Ç—Ä–æ–∏–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
    * –°–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º —Å—á–∏—Ç–∞–µ–º 7-–¥–Ω–µ–≤–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —á–∏—Å–ª—É –ø–æ–µ–∑–¥–æ–∫
    * —Ç–æ–ø-10 –∑–æ–Ω –ø–æ —á–∏—Å–ª—É –ø–æ–µ–∑–¥–æ–∫ –∑–∞ –¥–µ–Ω—å
  * –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Hive —Ç–∞–±–ª–∏—Ü—É (Parquet, partitioned by date)
## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
HDFS (raw trips, weather)\
 ‚îÇ\
 ‚ñº\
Spark (Scala job)\
  ‚îú‚îÄ‚îÄ –æ—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è\
  ‚îú‚îÄ‚îÄ join —Å –∑–æ–Ω–∞–º–∏ –∏ –ø–æ–≥–æ–¥–æ–π\
  ‚îú‚îÄ‚îÄ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ + –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏\
  ‚ñº\
Hive (Parquet, dwh.fact_taxi_hourly)
## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
  * Scala 2.11.12
  * Apache Spark 3.5.5
  * Hive 3.1.3
  * HDFS 3.3.6
  * –°–±–æ—Ä–∫–∞: build sbt
## üöÄ –ó–∞–ø—É—Å–∫
  * –°–æ–±—Ä–∞—Ç—å jar: sbt package
  * –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ YARN - –ø—Ä–∏–º–µ—Ä –≤ run.sh
  * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
    * TRIPS_PATH ‚Äî –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º –ø–æ–µ–∑–¥–æ–∫ –≤ HDFS
    * ZONES_PATH ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∑–æ–Ω
    * WEATHER_PATH ‚Äî –ø–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (hourly)
    * FROM_DT / TO_DT ‚Äî –ø–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2024-01-01)
## üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
.\
‚îú‚îÄ‚îÄ data/&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# –¥–∞—Ç–∞—Å–µ—Ç—ã\
‚îÇ   ‚îî‚îÄ‚îÄ yellow_tripdata_2025-01.parquet\
‚îÇ   ‚îî‚îÄ‚îÄ taxi_zone_lookup.csv\
‚îÇ   ‚îî‚îÄ‚îÄ nyc_weather_jan_2025.csv\
‚îú‚îÄ‚îÄ build.sbt&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# –∫–æ–Ω—Ñ–∏–≥ —Å–±–æ—Ä–∫–∏\
‚îú‚îÄ‚îÄ project/\
‚îÇ   ‚îî‚îÄ‚îÄ build.properties&emsp;&emsp;&emsp;&emsp;# –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ sbt\
‚îú‚îÄ‚îÄ NycTaxiHourlyJob.scala&emsp;&emsp;# –æ—Å–Ω–æ–≤–Ω–æ–π Spark job\
‚îú‚îÄ‚îÄ ddl.hql&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# –°–∫—Ä–∏–ø—Ç—ã HiveQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ë–î / —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥ –≤–∏—Ç—Ä–∏–Ω—É\
‚îú‚îÄ‚îÄ run.sh&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;# –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–π job-—ã\
‚îî‚îÄ‚îÄ README.md
## üë®‚Äçüè´ –ü—Ä–∏–º–µ—Ä—ã –º–µ—Ç—Ä–∏–∫
  * –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ –≤ –ú–∞–Ω—Ö—ç—Ç—Ç–µ–Ω–µ –≤ —á–∞—Å –ø–∏–∫ (17‚Äì19): ~12 –º–∏–Ω
  * 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–æ–∫ –≤ –¥–æ–∂–¥—å –≤—ã—à–µ –Ω–∞ 15%
  * Top-5 –∑–æ–Ω –ø–æ —á–∏—Å–ª—É –ø–æ–µ–∑–¥–æ–∫ –≤ —Å—É—Ç–∫–∏: Midtown, Upper East Side, JFK, LaGuardia, Downtown Brooklyn
## üîÑ –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
|zone_id|borough    |pickup_hour        |trips_cnt|avg_duration_min|p50_duration_min|p95_duration_min|avg_speed_kmh|revenue_usd|cash_share|temp_c|precip_mm|dt        |
|-------|----------|--------------------|---------|----------------|----------------|----------------|--------------|----------|-----------|------|---------|----------|
|142    |Manhattan  |2025-01-15 08:00:00|    2350 |           13.4 |            11.0|            29.0|         21.5 |    28350.6 |     0.28 |  -2.0|     0.0 |2025-01-15|
|236    |Queens     |2025-01-15 08:00:00|     940 |           18.7 |            16.0|            42.0|         28.3 |    11700.8 |     0.35 |  -1.8|     0.0 |2025-01-15|
|263    |Brooklyn   |2025-01-15 08:00:00|    1120 |           16.9 |            14.0|            38.0|         24.1 |    13290.4 |     0.31 |  -1.5|     0.0 |2025-01-15|
|132    |Manhattan  |2025-01-15 17:00:00|    4012 |           14.2 |            12.0|            34.0|         19.8 |    49720.1 |     0.25 |   1.2|     0.3 |2025-01-15|
|255    |Brooklyn   |2025-01-15 17:00:00|    1685 |           21.6 |            18.0|            55.0|         22.4 |    20250.5 |     0.38 |   1.5|     0.3 |2025-01-15|

–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π:
  * zone_id ‚Äî ID –∑–æ–Ω—ã –ø–æ—Å–∞–¥–∫–∏ (–∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ TLC)
  * borough ‚Äî —Ä–∞–π–æ–Ω (Manhattan, Brooklyn, Queens, Bronx, Staten Island)
  * pickup_hour ‚Äî –Ω–∞—á–∞–ª–æ —á–∞—Å–∞ (–ø–æ—á–∞—Å–æ–≤–æ–π —Å—Ä–µ–∑)
  * trips_cnt ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–µ–∑–¥–æ–∫ –∑–∞ —ç—Ç–æ—Ç —á–∞—Å –≤ –∑–æ–Ω–µ
  * avg_duration_min ‚Äî —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–∫–∏
  * p50_duration_min ‚Äî –º–µ–¥–∏–∞–Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  * p95_duration_min ‚Äî 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å
  * avg_speed_kmh ‚Äî —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å (–∫–º/—á)
  * revenue_usd ‚Äî —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–µ–∑–¥–æ–∫ (total_amount)
  * cash_share ‚Äî –¥–æ–ª—è –Ω–∞–ª–∏—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
  * temp_c ‚Äî —Å—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∑–∞ —ç—Ç–æ—Ç —á–∞—Å (–∏–∑ –ø–æ–≥–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
  * precip_mm ‚Äî —Å—É–º–º–∞ –æ—Å–∞–¥–∫–æ–≤ –∑–∞ —á–∞—Å
  * dt ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–∞—è –¥–∞—Ç–∞ (–ø–∞—Ä—Ç–∏—Ü–∏—è Hive)
